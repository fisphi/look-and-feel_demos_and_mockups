<!DOCTYPE html>
<html lang="de" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DIVINA look&feel DEMO: Personendatenverwaltung </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container-fluid py-4">

        <div class="row justify-content-center">
            <!-- Main Form -->
            <div class="col-md-9 col-lg-8 col-xl-7 order-md-1" style="max-width: 800px;">
        <div class="mb-3">
            <a href="../index.html" class="btn btn-outline-secondary rounded-pill px-3 py-1">
                ← Back to Demos
            </a>
        </div>
                <div data-bs-spy="scroll" data-bs-target="#navbar-sections" data-bs-smooth-scroll="true">
                    <h4 class="mb-4">
                        <div class="mb-4">
                            <span class="badge rounded-pill bg-secondary text-white me-1 small py-1 px-2">look&amp;feel</span>
                            <span class="badge rounded-pill bg-info text-white me-1 small py-1 px-2">mockup</span>
                            <span class="badge rounded-pill bg-warning text-dark me-1 small py-1 px-2">demo</span>
                            <span class="badge rounded-pill bg-danger text-white me-1 small py-1 px-2">draft</span>
                        </div>
                        Demo-Formular zur Erfassung von personenbezogenen Daten
                    </h4>
                    <p class="lead text-muted mb-4"><strong>Hinweis:</strong> Dies ist ein <i>look&feel</i> Mockup zur Demonstration von Eingabefeldern, Interaktionslogik und Funktionalitäten füŕ die Erfassung von per&shy;sonen&shy;bezogenen Daten. <br/>Dieses Formular ist nur für die praxisnahe Evaluierung gedacht!<br/></p>

                    <form id="personForm" novalidate>

                        <!-- 0. USER-ROLLE (GATE) -->
                        <section id="userrolle" class="form-section mb-5">
                            <div class="card border-primary">
                                <div class="card-header bg-primary text-white">
                                    <h3 class="h5 mb-0">
                                         User-Rolle wählen
                                        <small class="d-block mt-1 opacity-75">Wählen Sie als erstes eine User-Rolle:</small>
                                    </h3>
                                </div>
                                <div class="card-body">
                                    <div class="alert alert-info mb-3" role="alert">
                                        <i class="bi bi-shield-lock-fill me-2"></i>
                                        <strong>Wichtig:</strong> Ihre Rolle bestimmt, welche Bereiche Sie bearbeiten können.
                                    </div>
                                    <div class="row g-3">
                                        <div class="col-12">
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="radio" name="userrolle" id="rolle_kurator" value="kurator">
                                                <label class="form-check-label" for="rolle_kurator">
                                                    <strong>DB-Owner (Superadmin z.B: Kurator der PersonenDatenBank)</strong>
                                                    <br>
                                                    <small class="text-muted">Volle Bearbeitungsrechte für alle Sektionen</small>
                                                </label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="radio" name="userrolle" id="rolle_kustode" value="kustode">
                                                <label class="form-check-label" for="rolle_kustode">
                                                    <strong>Record-Owner (Sammlungsspezifische Admins z.B: Kustode / Kustodin der sammlungsspezifischen Personeneinträge)</strong>
                                                    <br>
                                                    <small class="text-muted">Lebensstatus und Identität sind schreibgeschützt</small>
                                                </label>
                                            </div>
                                            <div class="form-check mb-2">
                                                <input class="form-check-input" type="radio" name="userrolle" id="rolle_wissenschaftler" value="wissenschaftler">
                                                <label class="form-check-label" for="rolle_wissenschaftler">
                                                    <strong>Record-Editor (Sammlungsspezifische wissenschaftliche Mitarbeiter)</strong>
                                                    <br>
                                                    <small class="text-muted">Lebensstatus, Identität und Kontakt sind schreibgeschützt</small>
                                                </label>
                                            </div>
                                            <div class="form-check mb-3">
                                                <input class="form-check-input" type="radio" name="userrolle" id="rolle_user" value="user">
                                                <label class="form-check-label" for="rolle_user">
                                                    <strong>Record-Viewer (Sammlungsspezifische Mitarbeiter, read-only)</strong>
                                                    <br>
                                                    <small class="text-muted">Nur Kommentare abgeben möglich</small>
                                                </label>
                                            </div>
                                            
                                            <hr class="my-3">
                                            
                                            <div class="alert alert-success mb-0" role="alert">
                                                <i class="bi bi-shield-lock-fill me-2"></i>
                                                <strong>Draft</strong> Rollen- und Berechtigungsdefinitionen sind ein erste Überlegung <i>[tbd]</i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- 1. LEBENSSTATUS (GATE) -->
                        <section id="lebensstatus" class="form-section mb-5 disabled-section" data-role-restriction="wissenschaftler,user">
                            <div class="card">
                                <div class="card-header bg-primary text-white">
                                    <h3 class="h5 mb-0">Lebensstatus</h3>
                                    <small class="d-block mt-1 opacity-75">Ob die Person lebend oder verstorben ist, bestimmt den rechtlichen Rahmen für die Personendatenerfassung. Entsprechend werden einige Felder ausgeblendet. <i>[tbf]</i></small>
                                </div>
                                <div class="card-body">
                                    <div class="d-flex gap-3">
                                        <div class="lebensstatus-option">
                                            <input class="form-check-input" type="radio" name="lebensstatus" id="lebend" value="lebend">
                                            <label class="form-check-label" for="lebend">
                                                <i class="bi bi-person-check fs-4 d-block mb-2"></i>
                                                Lebend
                                            </label>
                                        </div>
                                        <div class="lebensstatus-option">
                                            <input class="form-check-input" type="radio" name="lebensstatus" id="verstorben" value="verstorben" checked>
                                            <label class="form-check-label" for="verstorben">
                                                <i class="bi bi-person-x fs-4 d-block mb-2"></i>
                                                Verstorben
                                            </label>
                                        </div>
                                        <div class="lebensstatus-option">
                                            <input class="form-check-input" type="radio" name="lebensstatus" id="unbekannt" value="unbekannt">
                                            <label class="form-check-label" for="unbekannt">
                                                <i class="bi bi-question-circle fs-4 d-block mb-2"></i>
                                                Unbekannt
                                            </label>
                                        </div>
                                    </div>
                                    <div class="invalid-feedback d-block" id="lebensstatusError" style="display:none!important"></div>
                                </div>
                            </div>
                        </section>

                        <!-- 2. ANZEIGENAME -->
                        <section id="anzeigename" class="form-section mb-5 disabled-section">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="h5 mb-0">Anzeigename</h3>
                                </div>
                                <div class="card-body">
                                    <div class="row g-3">
                                        <div class="col-12">
                                            <label class="form-label">Anzeigename und Suffixe (automatisch generiert)</label>
                                            <div class="alert alert-sec ondary mb-1" role="alert">
                                               <strong id="anzeigeNameDisplay" class="fs-5">—</strong> <small id="anzeigeNameDates" class="text-muted small">—</small></div>
                                            </div>
                                            <!-- <div class="alert alert-secondary mb-1" role="alert"></div> -->
                                                <!-- neue Zeile für Geburt/Tod/Wirkungszeitraum -->
                                                <!-- <div id="anzeigeNameDates" class="small text-muted mb-2"> </div> -->
                                                 <!-- <strong id="anzeigeNameDates" class="fs-5">—</strong>
                                             </div> -->
                                            <div class="form-text">Der Anzeigename wird automatisch aus Vorname, Mittelname und Nachname zusammengesetzt. Am Ende erscheint statisch <i>[Sammlung] und falls bekannt davor das [* Geburtsdatum], [† Sterbedatum], [(fl.) Wirkungszeitraum] sowie [Normdatenbank: ID+URL]</i>.</div>
                                        </div>
                                    </div>
                                
                            </div>
                        </section>

                        <!-- 3. IDENTITÄT -->
                        <section id="identitaet" class="form-section mb-5 disabled-section" data-role-restriction="wissenschaftler,user">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="h5 mb-0">Identität</h3>
                                </div>
                                <div class="card-body">
                                    <div class="row g-3 row-separator">
                                        <div class="col-md-4">
                                            <label for="vorname" class="form-label">Vorname</label>
                                            <input type="text" class="form-control" id="vorname" value="Ferdinand" name="vorname">
                                        </div>
                                        <div class="col-md-4">
                                            <label for="mittelname" class="form-label">Mittelname</label>
                                            <input type="text" class="form-control" id="mittelname"  name="mittelname">
                                        </div>
                                        <div class="col-md-4">
                                            <label for="nachname" class="form-label">Nachname <span class="text-danger">*</span></label>
                                            <input type="text" class="form-control" id="nachname" value="Hochstetter" name="nachname" required>
                                            <div class="invalid-feedback">Nachname ist erforderlich</div>
                                        </div>
                                        <div class="col-md-4">
                                            <label for="namenskuerzel" class="form-label">Namenskürzel</label>
                                            <input type="text" class="form-control" id="namenskuerzel" name="namenskuerzel">
                                        </div>
                                        <div class="col-md-8">
                                            <label class="form-label">Geschlecht</label>
                                            <div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="radio" name="geschlecht" id="geschlecht_w" value="w">
                                                    <label class="form-check-label" for="geschlecht_w">Weiblich</label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="radio" name="geschlecht" id="geschlecht_m" value="m" checked>
                                                    <label class="form-check-label" for="geschlecht_m">Männlich</label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="radio" name="geschlecht" id="geschlecht_div" value="div">
                                                    <label class="form-check-label" for="geschlecht_div">Divers</label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input class="form-check-input" type="radio" name="geschlecht" id="geschlecht_unbekannt" value="unbekannt">
                                                    <label class="form-check-label" for="geschlecht_unbekannt">Unbekannt</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="row g-3 row-separator">
                                        <div class="col-md-6">
                                            <div class="d-flex justify-content-between align-items-center">
                                                <label for="standes_und_amtstitel" class="form-label mb-0">Standes- und Amtstitel</label>
                                                <button type="button" class="btn btn-sm btn-outline-info" data-bs-toggle="modal" data-bs-target="#standesTitelModal">
                                                    <i class="bi bi-info-circle"></i>
                                                </button>
                                            </div>
                                            <div class="autocomplete-wrapper">
                                                <input type="text" class="form-control autocomplete-input" 
                                                       id="standes_und_amtstitel" name="standes_und_amtstitel"
                                                       data-autocomplete="standesTitel">
                                                <div class="autocomplete-dropdown"></div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="d-flex justify-content-between align-items-center">
                                                <label for="akademischer_titel" class="form-label mb-0">Akademischer Titel</label>
                                                <button type="button" class="btn btn-sm btn-outline-info" data-bs-toggle="modal" data-bs-target="#akademischeTitelModal">
                                                    <i class="bi bi-info-circle"></i>
                                                </button>
                                            </div>
                                            <div class="autocomplete-wrapper">
                                                <input type="text" class="form-control autocomplete-input" 
                                                       id="akademischer_titel" name="akademischer_titel"
                                                       data-autocomplete="akademischeTitel">
                                                <div class="autocomplete-dropdown"></div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="row g-3">
                                        <div class="col-12">
                                            <label class="form-label">Namensvarianten</label>
                                            <div id="namensvarianten-container">
                                                <!-- Pre-filled entries -->
                                                <div class="dynamic-field-row">
                                                    <input type="text" class="form-control flex-grow-1" name="namensvarianten[]" value="Ferdinand von Hochstetter">
                                                    <button type="button" class="btn btn-outline-danger btn-sm">
                                                        <i class="bi bi-trash"></i>
                                                    </button>
                                                </div>
                                                <div class="dynamic-field-row">
                                                    <input type="text" class="form-control flex-grow-1" name="namensvarianten[]" value="F. Hochstetter">
                                                    <button type="button" class="btn btn-outline-danger btn-sm">
                                                        <i class="bi bi-trash"></i>
                                                    </button>
                                                </div>
                                                <div class="dynamic-field-row">
                                                    <input type="text" class="form-control flex-grow-1" name="namensvarianten[]" value="Ferdl Hochstetter">
                                                    <button type="button" class="btn btn-outline-danger btn-sm">
                                                        <i class="bi bi-trash"></i>
                                                    </button>
                                                </div>
                                            </div>
                                            <button type="button" class="btn btn-sm btn-outline-primary" data-dynamic-add="namensvarianten">
                                                <i class="bi bi-plus-circle"></i> Namensvariante hinzufügen
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- 4. NORMDATEN -->
                        <section id="normdaten" class="form-section mb-5 disabled-section" data-role-restriction="user">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="h5 mb-0">Normdaten</h3>
                                </div>
                                <div class="card-body">
                                    <div class="row g-3 mb-4">
                                        <div class="col-12">
                                            <label for="orcid" class="form-label">ORCID</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" id="orcid" name="orcid"
                                                       placeholder="0000-0000-0000-000X oder URL"
                                                       data-validate="orcid">
                                                <a class="btn btn-outline-secondary"
                                                   href="https://orcid.org/0000-0002-0752-8735"
                                                   target="_blank" rel="noopener noreferrer">
                                                    ORCID Suche <i class="bi bi-box-arrow-up-right ms-1"></i>
                                                </a>
                                            </div>
                                            <div class="invalid-feedback">Ungültiges ORCID-Format</div>
                                            <div class="form-text">Eindeutige Kennung für Forschende.</div>
                                        </div>

                                        <div class="col-md-6">
                                            <label for="viaf" class="form-label">VIAF</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" id="viaf" name="viaf"
                                                       placeholder="Zahl oder URL"
                                                       data-validate="viaf">
                                                <a class="btn btn-outline-secondary" href="https://viaf.org/en/viaf/search?field=local%2Cnames&index=VIAF&searchTerms=Hochstetter+Ferdinand" target="_blank" rel="noopener noreferrer">
                                                    VIAF Suche <i class="bi bi-box-arrow-up-right ms-1"></i>
                                                </a>
                                            </div>
                                            <div class="form-text">Internationale Normdatei (VIAF ID).</div>
                                            <div class="invalid-feedback">Ungültiges VIAF-Format</div>
                                        </div>

                                        <div class="col-md-6">
                                            <label for="gnd" class="form-label">GND</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" id="gnd" name="gnd" value="119338467"
                                                       placeholder="Zahl oder URL"
                                                       data-validate="gnd">
                                                <a class="btn btn-success text-white" href="https://explore.gnd.network/gnd/119338467" target="_blank" rel="noopener noreferrer">GND Eintrag<i class="bi bi-box-arrow-right ms-1"></i>
                                                </a>
                                            </div>
                                            <div class="form-text">Gemeinsame Normdatei (GND).</div>
                                            <div class="invalid-feedback">Ungültiges GND-Format</div>
                                        </div>

                                        <div class="col-12 col-sm-6">
                                            <label for="wikidata" class="form-label">Wikidata</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" id="wikidata" name="wikidata"
                                                       placeholder="Q + Zahl"
                                                       data-validate="wikidata">
                                                <a class="btn btn-outline-secondary" href="https://www.wikidata.org/w/index.php?search=Hochstetter+Ferdinand" target="_blank" rel="noopener noreferrer">
                                                    Wikidata Suche <i class="bi bi-box-arrow-up-right ms-1"></i>
                                                </a>
                                            </div>
                                            <div class="form-text">Wikidata-Eintrag.</div>
                                            <div class="invalid-feedback">Ungültiges Wikidata-Format (Q + Zahl)</div>
                                        </div>

                                        <div class="col-12 col-sm-6">
                                            <label for="wikipedia" class="form-label">Wikipedia</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" id="wikipedia" name="wikipedia"
                                                       placeholder="URL"
                                                       data-validate="url">
                                                <a class="btn btn-outline-secondary" href="https://de.wikipedia.org/w/index.php?search=hochstetter+Ferdinand&title=Spezial%3ASuche&ns0=1" target="_blank" rel="noopener noreferrer">
                                                    Wikipedia Suche <i class="bi bi-box-arrow-up-right ms-1"></i>
                                                </a>
                                            </div>
                                            <div class="form-text">Wikipedia-Seite.</div>
                                            <div class="invalid-feedback">Ungültige URL</div>
                                        </div>
                                    </div>

                                    <div class="accordion" id="normdatenAccordion">
                                        <div class="accordion-item">
                                            <h2 class="accordion-header" id="normdatenAccordionHeading">
                                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#normdatenAccordionCollapse" aria-expanded="false" aria-controls="normdatenAccordionCollapse">
                                                    Weitere Normdatenbanken anzeigen
                                                </button>
                                            </h2>
                                            <div id="normdatenAccordionCollapse" class="accordion-collapse collapse" aria-labelledby="normdatenAccordionHeading" data-bs-parent="#normdatenAccordion">
                                                <div class="accordion-body">
                                                    <div class="row g-3">
                                                        <div class="col-md-6">
                                                            <label for="isni" class="form-label">ISNI</label>
                                                            <div class="input-group">
                                                                <input type="text" class="form-control" id="isni" name="isni"
                                                                       placeholder="16-stellig"
                                                                       data-validate="isni">
                                                                <a class="btn btn-outline-secondary" href="https://isni.oclc.org/cbs/DB=1.2/SET=1/TTL=1/CMD?ACT=SRCH&IKT=8006&SRT=LST_nd&TRM=Hochstetter+Ferdinand" target="_blank" rel="noopener noreferrer">
                                                                    ISNI Suche <i class="bi bi-box-arrow-up-right ms-1"></i>
                                                                </a>
                                                            </div>
                                                            <div class="form-text">Internationale Standardnummer.</div>
                                                            <div class="invalid-feedback">Ungültiges ISNI-Format (16 Ziffern)</div>
                                                        </div>

                                                        <div class="col-md-6">
                                                            <label for="lcnaf" class="form-label">LCNAF</label>
                                                            <div class="input-group">
                                                                <input type="text" class="form-control" id="lcnaf" name="lcnaf"
                                                                       placeholder="n + Zahl"
                                                                       data-validate="lcnaf">
                                                                <a class="btn btn-outline-secondary" href="https://authorities.loc.gov/search-results?searchFields=all&searchType=begins&searchTerm=Hochstetter+Ferdinand" target="_blank" rel="noopener noreferrer">
                                                                    LCNAF Suche <i class="bi bi-box-arrow-up-right ms-1"></i>
                                                                </a>
                                                            </div>
                                                            <div class="form-text">Library of Congress Name Authority File.</div>
                                                            <div class="invalid-feedback">Ungültiges LCNAF-Format (n + Zahl)</div>
                                                        </div>

                                                        <div class="col-md-6">
                                                            <label for="bnf" class="form-label">BNF</label>
                                                            <div class="input-group">
                                                                <input type="text" class="form-control" id="bnf" name="bnf"
                                                                       placeholder="cb + Zahl"
                                                                       data-validate="bnf">
                                                                <a class="btn btn-outline-secondary" href="https://catalogue.bnf.fr/rechercher.do?motRecherche=Hochstetter+Ferdinand" target="_blank" rel="noopener noreferrer">
                                                                    BNF Suche <i class="bi bi-box-arrow-up-right ms-1"></i>
                                                                </a>
                                                            </div>
                                                            <div class="form-text">Bibliothèque nationale de France.</div>
                                                            <div class="invalid-feedback">Ungültiges BNF-Format (cb + Zahl)</div>
                                                        </div>

                                                        <div class="col-md-6">
                                                            <label for="bhl" class="form-label">BHL</label>
                                                            <div class="input-group">
                                                                <input type="text" class="form-control" id="bhl" name="bhl"
                                                                       placeholder="Zahl oder URL"
                                                                       data-validate="bhl">
                                                                <a class="btn btn-outline-secondary" href="https://www.biodiversitylibrary.org/search?searchTerm=Hochstetter+Ferdinand" target="_blank" rel="noopener noreferrer">
                                                                    BHL Suche <i class="bi bi-box-arrow-up-right ms-1"></i>
                                                                </a>
                                                            </div>
                                                            <div class="form-text">Biodiversity Heritage Library (Author ID).</div>
                                                            <div class="invalid-feedback">Ungültiges BHL-Format</div>
                                                        </div>

                                                        <div class="col-md-6">
                                                            <label for="zoobank" class="form-label">ZooBank</label>
                                                            <div class="input-group">
                                                                <input type="text" class="form-control" id="zoobank" name="zoobank"
                                                                       placeholder="UUID/LSID"
                                                                       data-validate="zoobank">
                                                                <a class="btn btn-outline-secondary" href="https://www.zoobank.org/Search?search_term=Hochstetter+Ferdinands" target="_blank" rel="noopener noreferrer">
                                                                    ZooBank Suche <i class="bi bi-box-arrow-up-right ms-1"></i>
                                                                </a>
                                                            </div>
                                                            <div class="form-text">Zoologische Namensdatenbank.</div>
                                                            <div class="invalid-feedback">Ungültiges ZooBank-Format</div>
                                                        </div>

                                                        <div class="col-md-6">
                                                            <label for="zobodat" class="form-label">ZOBODAT</label>
                                                            <div class="input-group">
                                                                <input type="text" class="form-control" id="zobodat" name="zobodat"
                                                                       placeholder="URL"
                                                                       data-validate="url">
                                                                <a class="btn btn-outline-secondary" href="https://www.zobodat.at/personen.php?q=+&as_p%5B0%5D%5Bi%5D=forename&as_p%5B0%5D%5Bqt%5D=contains&as_p%5B0%5D%5Bv%5D=Ferdinand&as_p%5B1%5D%5Bi%5D=surname&as_p%5B1%5D%5Bqt%5D=contains&as_p%5B1%5D%5Bv%5D=Hochstetter&as_p%5B2%5D%5Bi%5D=" target="_blank" rel="noopener noreferrer">
                                                                    ZOBODAT Suche <i class="bi bi-box-arrow-up-right ms-1"></i>
                                                                </a>
                                                            </div>
                                                            <div class="form-text">Zoologisch-Botanische Datenbank.</div>
                                                            <div class="invalid-feedback">Ungültige URL</div>
                                                        </div>

                                                        <div class="col-md-6">
                                                            <label for="ulan" class="form-label">ULAN</label>
                                                            <div class="input-group">
                                                                <input type="text" class="form-control" id="ulan" name="ulan"
                                                                       placeholder="Zahl oder URL"
                                                                       data-validate="ulan">
                                                                <a class="btn btn-outline-secondary" href="https://www.getty.edu/vow/ULANServlet?english=Y&find=Hochstetter+Ferdinand&role=&page=1&nation=" target="_blank" rel="noopener noreferrer">
                                                                    ULAN Suche <i class="bi bi-box-arrow-up-right ms-1"></i>
                                                                </a>
                                                            </div>
                                                            <div class="form-text">Getty Union List of Artist Names.</div>
                                                            <div class="invalid-feedback">Ungültiges ULAN-Format</div>
                                                        </div>

                                                        <div class="col-md-6">
                                                            <label for="ipni" class="form-label">IPNI</label>
                                                            <div class="input-group">
                                                                <input type="text" class="form-control" id="ipni" name="ipni"
                                                                       placeholder="URL"
                                                                       data-validate="url">
                                                                <a class="btn btn-outline-secondary" href="https://www.ipni.org/search?q=Hochstetter%20Ferdinand" target="_blank" rel="noopener noreferrer">
                                                                    IPNI Suche <i class="bi bi-box-arrow-up-right ms-1"></i>
                                                                </a>
                                                            </div>
                                                            <div class="form-text">IPNI (International Plant Names Index).</div>
                                                            <div class="invalid-feedback">Ungültige URL</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- 5. LEBENSDATEN -->
                        <section id="lebensdaten" class="form-section mb-5 disabled-section" data-role-restriction="user">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="h5 mb-0">Lebensdaten</h3>
                                </div>
                                <div class="card-body">
                                    <div class="row g-3 row-separator">
                                        <div class="col-md-6">
                                            <label for="geburtsdatum" class="form-label">Geburtsdatum (EDTF)</label>
                                            <input type="text" class="form-control" id="geburtsdatum" name="geburtsdatum" value="1829-04-30" 
                                                   placeholder=""
                                                   data-validate="edtf">
                                            <div class="form-text">Format: YYYY oder YYYY-MM oder YYYY-MM-DD</div>
                                            <div class="invalid-feedback">Ungültiges EDTF-Format</div>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="geburtsort" class="form-label">Geburtsort</label>
                                            <input type="text" class="form-control" id="geburtsort" name="geburtsort">
                                        </div>
                                    </div>
                                    
                                    <div class="row g-3 row-separator">
                                        <div class="col-md-6">
                                            <label for="sterbedatum" class="form-label">Sterbedatum (EDTF)</label>
                                            <input type="text" class="form-control" id="sterbedatum" name="sterbedatum"  value="1884-07-18" 
                                                   placeholder=""
                                                   data-validate="edtf">
                                            <div class="form-text">Format: YYYY oder YYYY-MM oder YYYY-MM-DD</div>
                                            <div class="invalid-feedback">Ungültiges EDTF-Format</div>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="sterbeort" class="form-label">Sterbeort</label>
                                            <input type="text" class="form-control" id="sterbeort" name="sterbeort">
                                        </div>
                                    </div>
                                    
                                    <div class="row g-3 row-separator">
                                        <div class="col-md-6">
                                            <label for="wirkungszeitraum_von" class="form-label">Wirkungszeitraum von (EDTF)</label>
                                            <input type="text" class="form-control" id="wirkungszeitraum_von" name="wirkungszeitraum_von"
                                                   placeholder=""
                                                   data-validate="edtf">
                                            <div class="form-text">Format: YYYY oder YYYY-MM oder YYYY-MM-DD</div>
                                            <div class="invalid-feedback">Ungültiges EDTF-Format</div>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="wirkungszeitraum_bis" class="form-label">Wirkungszeitraum bis (EDTF)</label>
                                            <input type="text" class="form-control" id="wirkungszeitraum_bis" name="wirkungszeitraum_bis"
                                                   placeholder=""
                                                   data-validate="edtf">
                                            <div class="form-text">Format: YYYY oder YYYY-MM oder YYYY-MM-DD</div>
                                            <div class="invalid-feedback">Ungültiges EDTF-Format</div>
                                        </div>
                                    </div>
                                    
                                    <div class="row g-3">
                                        <div class="col-12">
                                            <label class="form-label">Datum ohne Kontext (EDTF)</label>
                                            <div id="datum-ohne-kontext-container"></div>
                                            <button type="button" class="btn btn-sm btn-outline-primary" data-dynamic-add="datumOhneKontext">
                                                <i class="bi bi-plus-circle"></i> Datum hinzufügen
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- 6. TÄTIGKEITEN / ROLLEN -->
                        <section id="taetigkeiten" class="form-section mb-5 disabled-section" data-role-restriction="user">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="h5 mb-0">Tätigkeiten / Rollen</h3>
                                    <small class="text-muted">
                                        Timeline der wichtigsten Stationen <br>
                                        <i><code>[tbd: Merge into Wirkungsorte (same, same like Wirkungsorte)]</code></i>
                                    </small>
                                </div>
                                <div class="card-body">

                                    <div class="timeline-list">
                                        <div class="card mb-3 shadow-sm">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between align-items-start mb-2">
                                                    <div>
                                                        <span class="badge bg-primary me-2">1853–1856</span>
                                                        <strong>Geologische Aufnahmen</strong>
                                                        <div class="text-muted small">k.k. Geologische Reichsanstalt · Böhmischer Wald</div>
                                                    </div>
                                                    <span class="badge bg-warning text-dark">Feldgeologe</span>
                                                </div>
                                                <p class="mb-0 small text-muted">Detailkartierung der Grenzregion, Fokus auf stratigraphische Profile.</p>
                                            </div>
                                        </div>
                                        <div class="card mb-3 shadow-sm">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between align-items-start mb-2">
                                                    <div>
                                                        <span class="badge bg-primary me-2">1853–1856</span>
                                                        <strong>Geologische Arbeiten</strong>
                                                        <div class="text-muted small">k.k. Geologische Reichsanstalt · Fichtelgebirge &amp; Karlsbader Gebirge</div>
                                                    </div>
                                                    <span class="badge bg-warning text-dark">Petrologe</span>
                                                </div>
                                                <p class="mb-0 small text-muted">Analyse vulkanischer Gesteine und Ableitung regionaler Lagerstättenmodelle.</p>
                                            </div>
                                        </div>
                                        <div class="card mb-3 shadow-sm">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between align-items-start mb-2">
                                                    <div>
                                                        <span class="badge bg-primary me-2">1857–1859</span>
                                                        <strong>Wissenschaftlicher Geologe</strong>
                                                        <div class="text-muted small">Novara-Expedition · Weltweite Reise</div>
                                                    </div>
                                                    <span class="badge bg-success text-dark">Expeditionsgeologe</span>
                                                </div>
                                                <p class="mb-0 small text-muted">Globale Sammlung von Vergleichsmaterial für die kaiserliche Sammlung.</p>
                                            </div>
                                        </div>
                                        <div class="card mb-3 shadow-sm">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between align-items-start mb-2">
                                                    <div>
                                                        <span class="badge bg-primary me-2">1858–1859</span>
                                                        <strong>Geologische Feldforschung</strong>
                                                        <div class="text-muted small">Neuseeland-Feldmission · Auckland / Nord- &amp; Südinsel</div>
                                                    </div>
                                                    <span class="badge bg-success text-dark">Feldforscher</span>
                                                </div>
                                                <p class="mb-0 small text-muted">Kartierung vulkanischer Aktivitätszonen und Dokumentation traditioneller Ortsnamen.</p>
                                            </div>
                                        </div>
                                        <div class="card mb-3 shadow-sm">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between align-items-start mb-2">
                                                    <div>
                                                        <span class="badge bg-primary me-2">1860–1874</span>
                                                        <strong>Professor für Mineralogie &amp; Geologie</strong>
                                                        <div class="text-muted small">Polytechnisches Institut Wien · Lehrstuhl</div>
                                                    </div>
                                                    <span class="badge bg-secondary text-dark">Professor</span>
                                                </div>
                                                <p class="mb-0 small text-muted">Aufbau des ersten praxisorientierten Curriculums für Lagerstättenkunde.</p>
                                            </div>
                                        </div>
                                        <div class="card mb-3 shadow-sm">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between align-items-start mb-2">
                                                    <div>
                                                        <span class="badge bg-primary me-2">1874–1875</span>
                                                        <strong>Rektor</strong>
                                                        <div class="text-muted small">Polytechnisches Institut Wien · Direktion &amp; Verwaltung</div>
                                                    </div>
                                                    <span class="badge bg-dark text-white">Rektor</span>
                                                </div>
                                                <p class="mb-0 small text-muted">Reform der Studienordnung und Einführung eines Laborjournals für Studierende.</p>
                                            </div>
                                        </div>
                                        <div class="card mb-3 shadow-sm">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between align-items-start mb-2">
                                                    <div>
                                                        <span class="badge bg-primary me-2">1866–1882</span>
                                                        <strong>Präsident &amp; Tutor</strong>
                                                        <div class="text-muted small">Österreichische Geographische Gesellschaft · Mentoring &amp; Lehre</div>
                                                    </div>
                                                    <span class="badge bg-info text-dark">Mentor</span>
                                                </div>
                                                <p class="mb-0 small text-muted">Betreuung junger Geograf*innen und Entwicklung von Feldforschungsleitfäden.</p>
                                            </div>
                                        </div>
                                        <div class="card mb-3 shadow-sm">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between align-items-start mb-2">
                                                    <div>
                                                        <span class="badge bg-primary me-2">1876–1884</span>
                                                        <strong>Intendant / Direktor</strong>
                                                        <div class="text-muted small">Naturhistorisches Museum Wien · Museumsleitung</div>
                                                    </div>
                                                    <span class="badge bg-danger text-white">Direktor</span>
                                                </div>
                                                <p class="mb-0 small text-muted">Planung des Museumsneubaus und Umsetzung der ersten Dauerausstellung zur Geologie.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                                                <div class="card-body">
                                                                    <div id="taetigkeiten-container">
                                                                        <!-- Tätigkeit 1 (Pre-filled) -->
                                                                        <div class="taetigkeiten-entry border rounded p-3 mb-3">
                                                                            <div class="d-flex justify-content-between align-items-center mb-3">
                                                                                <h6 class="mb-0">Tätigkeit #1</h6>
                                                                                <button type="button" class="btn btn-sm btn-outline-danger" disabled
                                                                                    onclick="this.closest('.taetigkeiten-entry').remove()">
                                                                                    <i class="bi bi-trash"></i> Entfernen
                                                                                </button>
                                                                            </div>
                                                                            <div class="row g-3">
                                                                                <div class="col-md-6">
                                                                                    <label class="form-label">Beruf / Funktion</label>
                                                                                    <input type="text" class="form-control" name="beruf_funktion[]" value="Kurator">
                                                                                </div>
                                                                                <div class="col-md-6">
                                                                                    <label class="form-label">Institution</label>
                                                                                    <div class="autocomplete-wrapper">
                                                                                        <input type="text" class="form-control autocomplete-input" name="institution[]"
                                                                                            data-autocomplete="institutionen" value="Naturhistorisches Museum Wien">
                                                                                        <div class="autocomplete-dropdown"></div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="col-md-6">
                                                                                    <label class="form-label">Abteilung</label>
                                                                                    <input type="text" class="form-control" name="abteilung[]" value="Zoologie">
                                                                                </div>
                                                                                <div class="col-md-6">
                                                                                    <label class="form-label">Zeitraum</label>
                                                                                    <input type="text" class="form-control" name="zeitraum[]" placeholder="z.B. 1990-2000"
                                                                                        value="1857–1859">
                                                                                </div>
                                                                                <div class="col-12">
                                                                                    <label class="form-label">Rollen</label>
                                                                                    <div class="rollen-container-1">
                                                                                        <div class="dynamic-field-row">
                                                                                            <div class="autocomplete-wrapper flex-grow-1">
                                                                                                <input type="text" class="form-control autocomplete-input" name="rollen_1[]"
                                                                                                    data-autocomplete="rollen" value="Sammler">
                                                                                                <div class="autocomplete-dropdown"></div>
                                                                                            </div>
                                                                                            <button type="button" class="btn btn-outline-danger btn-sm">
                                                                                                <i class="bi bi-trash"></i>
                                                                                            </button>
                                                                                        </div>
                                                                                    </div>
                                                                                    <button type="button" class="btn btn-sm btn-outline-primary" onclick="addRolleToEntry(this, 1)">
                                                                                        <i class="bi bi-plus-circle"></i> Rolle hinzufügen
                                                                                    </button>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                
                                                                    <button type="button" class="btn btn-outline-primary" id="addTaetigkeitBtn">
                                                                        <i class="bi bi-plus-circle"></i> Weitere Tätigkeit hinzufügen
                                                                    </button>
                            </div>
                        </section>

                        <!-- 7. ORTE -->
                        <section id="orte" class="form-section mb-5 disabled-section" data-role-restriction="user">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="h5 mb-0">Wirkungsorte</h3>
                                    <small class="text-muted">
                                        Wirkungsorte der wichtigsten Lebensstationen <br>
                                        <i><code>[tbd: Merge into Tätigkeiten / Rollen (same, same like Tätigkeiten / Rollen)]</code></i>
                                    </small>
                                </div>
                                <div class="card-body">
                                    <div id="wirkungsorte-container">
                                        <div class="wirkungsort-item card shadow-sm mb-3">
                                            <div class="card-body">
                                                <div class="d-flex flex-wrap align-items-start gap-3">
                                                    <div class="flex-grow-1">
                                                        <div class="d-flex flex-wrap align-items-center gap-2">
                                                            <strong class="location-name">Böhmischer Wald</strong>
                                                            <a class="btn btn-sm btn-outline-secondary rounded-pill" href="https://www.openstreetmap.org/search?query=B%C3%B6hmischer%20Wald" target="_blank" rel="noopener noreferrer">
                                                                <i class="bi bi-globe"></i><span class="ms-1">Karte</span>
                                                            </a>
                                                            <span class="badge bg-secondary text-dark">Station · Böhmen</span>
                                                        </div>
                                                        <div class="wirkungsort-meta mt-2">
                                                            <span class="badge bg-primary text-dark">1853 – 1856</span>
                                                            <span class="text-muted small">k.k. Geologische Reichsanstalt · Detailkartierung</span>
                                                        </div>
                                                    </div>
                                                    <div class="wirkungsort-actions d-flex gap-2">
                                                        <button type="button" class="btn btn-outline-primary btn-sm" aria-label="Böhmischer Wald bearbeiten">
                                                            <i class="bi bi-pencil"></i>
                                                        </button>
                                                        <button type="button" class="btn btn-outline-danger btn-sm" aria-label="Böhmischer Wald entfernen">
                                                            <i class="bi bi-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="wirkungsort-item card shadow-sm mb-3">
                                            <div class="card-body">
                                                <div class="d-flex flex-wrap align-items-start gap-3">
                                                    <div class="flex-grow-1">
                                                        <div class="d-flex flex-wrap align-items-center gap-2">
                                                            <strong class="location-name">Fichtelgebirge &amp; Karlsbader Gebirge</strong>
                                                            <a class="btn btn-sm btn-outline-secondary rounded-pill" href="https://www.openstreetmap.org/search?query=Fichtelgebirge" target="_blank" rel="noopener noreferrer">
                                                                <i class="bi bi-globe"></i><span class="ms-1">Karte</span>
                                                            </a>
                                                            <span class="badge bg-secondary text-dark">Gesteinsanalyse</span>
                                                        </div>
                                                        <div class="wirkungsort-meta mt-2">
                                                            <span class="badge bg-primary text-dark">1853 – 1856</span>
                                                            <span class="text-muted small">Fichtel- &amp; Karlsbader Gebirge · Petrologische Profile</span>
                                                        </div>
                                                    </div>
                                                    <div class="wirkungsort-actions d-flex gap-2">
                                                        <button type="button" class="btn btn-outline-primary btn-sm" aria-label="Fichtelgebirge bearbeiten">
                                                            <i class="bi bi-pencil"></i>
                                                        </button>
                                                        <button type="button" class="btn btn-outline-danger btn-sm" aria-label="Fichtelgebirge entfernen">
                                                            <i class="bi bi-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="wirkungsort-item card shadow-sm mb-3">
                                            <div class="card-body">
                                                <div class="d-flex flex-wrap align-items-start gap-3">
                                                    <div class="flex-grow-1">
                                                        <div class="d-flex flex-wrap align-items-center gap-2">
                                                            <strong class="location-name">Novara-Expedition (weltweit)</strong>
                                                            <a class="btn btn-sm btn-outline-secondary rounded-pill" href="https://www.openstreetmap.org/search?query=novara%20expedition" target="_blank" rel="noopener noreferrer">
                                                                <i class="bi bi-globe"></i><span class="ms-1">Karte</span>
                                                            </a>
                                                            <span class="badge bg-success text-dark">Expedition</span>
                                                        </div>
                                                        <div class="wirkungsort-meta mt-2">
                                                            <span class="badge bg-primary text-dark">1857 – 1859</span>
                                                            <span class="text-muted small">Kaiserliche Weltumsegelung · Vergleichsmaterial</span>
                                                        </div>
                                                    </div>
                                                    <div class="wirkungsort-actions d-flex gap-2">
                                                        <button type="button" class="btn btn-outline-primary btn-sm" aria-label="Novara-Expedition bearbeiten">
                                                            <i class="bi bi-pencil"></i>
                                                        </button>
                                                        <button type="button" class="btn btn-outline-danger btn-sm" aria-label="Novara-Expedition entfernen">
                                                            <i class="bi bi-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="wirkungsort-item card shadow-sm mb-3">
                                            <div class="card-body">
                                                <div class="d-flex flex-wrap align-items-start gap-3">
                                                    <div class="flex-grow-1">
                                                        <div class="d-flex flex-wrap align-items-center gap-2">
                                                            <strong class="location-name">Neuseeland · Auckland / Nord- &amp; Südinsel</strong>
                                                            <a class="btn btn-sm btn-outline-secondary rounded-pill" href="https://www.openstreetmap.org/search?query=Neuseeland" target="_blank" rel="noopener noreferrer">
                                                                <i class="bi bi-globe"></i><span class="ms-1">Karte</span>
                                                            </a>
                                                            <span class="badge bg-success text-dark">Feldforschung</span>
                                                        </div>
                                                        <div class="wirkungsort-meta mt-2">
                                                            <span class="badge bg-primary text-dark">1858-12 – 1859-12</span>
                                                            <span class="text-muted small">Kartierung vulkanischer Aktivitätszonen</span>
                                                        </div>
                                                    </div>
                                                    <div class="wirkungsort-actions d-flex gap-2">
                                                        <button type="button" class="btn btn-outline-primary btn-sm" aria-label="Neuseeland bearbeiten">
                                                            <i class="bi bi-pencil"></i>
                                                        </button>
                                                        <button type="button" class="btn btn-outline-danger btn-sm" aria-label="Neuseeland entfernen">
                                                            <i class="bi bi-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="wirkungsort-item card shadow-sm mb-3">
                                            <div class="card-body">
                                                <div class="d-flex flex-wrap align-items-start gap-3">
                                                    <div class="flex-grow-1">
                                                        <div class="d-flex flex-wrap align-items-center gap-2">
                                                            <strong class="location-name">Wien, Österreich</strong>
                                                            <a class="btn btn-sm btn-outline-secondary rounded-pill" href="https://www.openstreetmap.org/search?query=Wien%2C%20%C3%96sterreich" target="_blank" rel="noopener noreferrer">
                                                                <i class="bi bi-globe"></i><span class="ms-1">Karte</span>
                                                            </a>
                                                            <span class="badge bg-warning text-dark">Polytechnisches Institut</span>
                                                        </div>
                                                        <div class="wirkungsort-meta mt-2">
                                                            <span class="badge bg-primary text-dark">1860 – 1874</span>
                                                            <span class="text-muted small">Professor für Mineralogie &amp; Geologie</span>
                                                        </div>
                                                    </div>
                                                    <div class="wirkungsort-actions d-flex gap-2">
                                                        <button type="button" class="btn btn-outline-primary btn-sm" aria-label="Wien 1860 bearbeiten">
                                                            <i class="bi bi-pencil"></i>
                                                        </button>
                                                        <button type="button" class="btn btn-outline-danger btn-sm" aria-label="Wien 1860 entfernen">
                                                            <i class="bi bi-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="wirkungsort-item card shadow-sm mb-3">
                                            <div class="card-body">
                                                <div class="d-flex flex-wrap align-items-start gap-3">
                                                    <div class="flex-grow-1">
                                                        <div class="d-flex flex-wrap align-items-center gap-2">
                                                            <strong class="location-name">Wien, Österreich</strong>
                                                            <a class="btn btn-sm btn-outline-secondary rounded-pill" href="https://www.openstreetmap.org/search?query=Wien%2C%20%C3%96sterreich" target="_blank" rel="noopener noreferrer">
                                                                <i class="bi bi-globe"></i><span class="ms-1">Karte</span>
                                                            </a>
                                                            <span class="badge bg-dark text-white">Rektorat</span>
                                                        </div>
                                                        <div class="wirkungsort-meta mt-2">
                                                            <span class="badge bg-primary text-dark">1874 – 1875</span>
                                                            <span class="text-muted small">Polytechnisches Institut · Verwaltung</span>
                                                        </div>
                                                    </div>
                                                    <div class="wirkungsort-actions d-flex gap-2">
                                                        <button type="button" class="btn btn-outline-primary btn-sm" aria-label="Wien 1874 bearbeiten">
                                                            <i class="bi bi-pencil"></i>
                                                        </button>
                                                        <button type="button" class="btn btn-outline-danger btn-sm" aria-label="Wien 1874 entfernen">
                                                            <i class="bi bi-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="wirkungsort-item card shadow-sm mb-3">
                                            <div class="card-body">
                                                <div class="d-flex flex-wrap align-items-start gap-3">
                                                    <div class="flex-grow-1">
                                                        <div class="d-flex flex-wrap align-items-center gap-2">
                                                            <strong class="location-name">Wien, Österreich</strong>
                                                            <a class="btn btn-sm btn-outline-secondary rounded-pill" href="https://www.openstreetmap.org/search?query=Wien%2C%20%C3%96sterreich" target="_blank" rel="noopener noreferrer">
                                                                <i class="bi bi-globe"></i><span class="ms-1">Karte</span>
                                                            </a>
                                                            <span class="badge bg-info text-dark">Mentoring</span>
                                                        </div>
                                                        <div class="wirkungsort-meta mt-2">
                                                            <span class="badge bg-primary text-dark">1866 – 1882</span>
                                                            <span class="text-muted small">Österreichische Geographische Gesellschaft</span>
                                                        </div>
                                                    </div>
                                                    <div class="wirkungsort-actions d-flex gap-2">
                                                        <button type="button" class="btn btn-outline-primary btn-sm" aria-label="Wien 1866 bearbeiten">
                                                            <i class="bi bi-pencil"></i>
                                                        </button>
                                                        <button type="button" class="btn btn-outline-danger btn-sm" aria-label="Wien 1866 entfernen">
                                                            <i class="bi bi-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="wirkungsort-item card shadow-sm mb-3">
                                            <div class="card-body">
                                                <div class="d-flex flex-wrap align-items-start gap-3">
                                                    <div class="flex-grow-1">
                                                        <div class="d-flex flex-wrap align-items-center gap-2">
                                                            <strong class="location-name">Wien, Österreich</strong>
                                                            <a class="btn btn-sm btn-outline-secondary rounded-pill" href="https://www.openstreetmap.org/search?query=Wien%2C%20%C3%96sterreich" target="_blank" rel="noopener noreferrer">
                                                                <i class="bi bi-globe"></i><span class="ms-1">Karte</span>
                                                            </a>
                                                            <span class="badge bg-danger text-white">Museumsleitung</span>
                                                        </div>
                                                        <div class="wirkungsort-meta mt-2">
                                                            <span class="badge bg-primary text-dark">1876 – 1884</span>
                                                            <span class="text-muted small">Naturhistorisches Museum Wien · Intendanz</span>
                                                        </div>
                                                    </div>
                                                    <div class="wirkungsort-actions d-flex gap-2">
                                                        <button type="button" class="btn btn-outline-primary btn-sm" aria-label="Wien 1876 bearbeiten">
                                                            <i class="bi bi-pencil"></i>
                                                        </button>
                                                        <button type="button" class="btn btn-outline-danger btn-sm" aria-label="Wien 1876 entfernen">
                                                            <i class="bi bi-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <button type="button" id="addWirkungsortBtn" class="btn btn-sm btn-outline-primary">
                                        <i class="bi bi-plus-circle"></i> Wirkungsort hinzufügen
                                    </button>
                                </div>
                            </div>
                        </section>

                        <!-- 8. KONTAKT (SENSITIV) -->
                        <section id="kontakt" class="form-section mb-5" data-role-restriction="wissenschaftler,user">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="h5 mb-0">Kontakt (Sensitiv)</h3>
                                </div>
                                <div class="card-body">
                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="checkbox" id="einwilligung" name="einwilligung">
                                        <label class="form-check-label" for="einwilligung">
                                            <strong>Einwilligung liegt vor</strong>
                                        </label>
                                    </div>
                                    <div id="kontakt-fields">
                                        <div class="row g-3">
                                            <div class="col-md-6">
                                                <label for="email" class="form-label">E-Mail</label>
                                                <input type="email" class="form-control" id="email" name="email"
                                                       data-validate="email">
                                                <div class="invalid-feedback">Ungültige E-Mail-Adresse</div>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="telefon" class="form-label">Telefon</label>
                                                <input type="tel" class="form-control" id="telefon" name="telefon"
                                                       data-validate="telefon">
                                                <div class="invalid-feedback">Ungültige Telefonnummer</div>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="mobil" class="form-label">Mobil</label>
                                                <input type="tel" class="form-control" id="mobil" name="mobil"
                                                       data-validate="telefon">
                                                <div class="invalid-feedback">Ungültige Mobilnummer</div>
                                            </div>
                                            <div class="col-md-6">
                                                <label for="fax" class="form-label">Fax</label>
                                                <input type="tel" class="form-control" id="fax" name="fax"
                                                       data-validate="telefon">
                                                <div class="invalid-feedback">Ungültige Faxnummer</div>
                                            </div>
                                            <div class="col-12">
                                                <label for="adresse_roh" class="form-label">Adresse</label>
                                                <textarea class="form-control" id="adresse_roh" name="adresse_roh" rows="3"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- 9. QUELLENANGABEN -->
                        <section id="quellenangaben" class="form-section mb-5 disabled-section" data-role-restriction="user">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="h5 mb-0">Quellenangaben</h3>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th style="width: 55%;">Quellenangabe</th>
                                                    <th style="width: 25%;">Erfasst von</th>
                                                    <th style="width: 20%;">Datum</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                
                                                <tr>
                                                    <td>Archiv des Naturhistorischen Museums, Personalakte Nr. 5678/1920</td>
                                                    <td>
                                                        <strong>Kati Schmidt</strong>
                                                        <br>
                                                        <span class="badge bg-warning text-dark">DB Owner</span>
                                                    </td>
                                                    <td>
                                                        <small class="text-muted">15.01.2024<br>14:30</small>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>Österreichisches Staatsarchiv, Bestand Naturhistorisches Museum, Karton 42</td>
                                                    <td>
                                                        <strong>Anna Wüller</strong>
                                                        <br>
                                                        <span class="badge bg-primary">Record Owner</span>
                                                    </td>
                                                    <td>
                                                        <small class="text-muted">12.01.2024<br>10:15</small>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>Bibliothek des Naturhistorischen Museums, Katalog 1812-1842, S. 21</td>
                                                    <td>
                                                        <strong>Oliver Mayer</strong>
                                                        <br>
                                                        <span class="badge bg-primary">Record Owner</span>
                                                    </td>
                                                    <td>
                                                        <small class="text-muted">08.01.2024<br>09:00</small>
                                                    </td>
                                                </tr>

                                                <tr>
                                                    <td>Tiroler Landesarchiv, Nachlass Johann Müller, Sign. NL-JM-1885</td>
                                                    <td>
                                                        <strong>Michaela Berger</strong>
                                                        <br>
                                                        <span class="badge bg-primary">Record Owner</span>
                                                    </td>
                                                    <td>
                                                        <small class="text-muted">10.01.2024<br>15:20</small>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>Bibliothek des Naturhistorischen Museums, Katalog 1852-1862, S. 234</td>
                                                    <td>
                                                        <strong>Martin Weber</strong>
                                                        <br>
                                                        <span class="badge bg-primary">Record Owner</span>
                                                    </td>
                                                    <td>
                                                        <small class="text-muted">08.01.2024<br>09:00</small>
                                                    </td>
                                                </tr>

                                            </tbody>
                                        </table>
                                    </div>
                                    
                                    <button type="button" class="btn btn-sm btn-outline-primary mt-2">
                                        <i class="bi bi-plus-circle"></i> Neue Quellenangabe hinzufügen
                                    </button>
                                </div>
                            </div>
                        </section>

                        <!-- 10. ANMERKUNGEN UND KOMMENTARE -->
                        <section id="meta" class="form-section mb-5 disabled-section" data-role-restriction="user">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="h5 mb-0">Anmerkungen und Kommentare</h3>
                                </div>
                                <div class="card-body">
                                    <div class="alert alert-info d-flex align-items-start mb-3" role="alert">
                                        <i class="bi bi-chat-left-text-fill me-2 fs-5"></i>
                                        <div>
                                            <strong>Hinweis:</strong> In diesem Bereich können Sie zusätzliche Informationen zur Person dokumentieren. 
                                            Nutzen Sie die Anmerkungen für ausführliche Notizen, den Kommentar für kurze Hinweise und die Quelle 
                                            zur Angabe der Herkunft der Informationen.
                                        </div>
                                    </div>

                                    <!-- Dummy Anmerkungen mit Kommentaren -->
                                    <div class="mb-4">
                                        <h6 class="mb-3">Bisherige Anmerkungen</h6>
                                        
                                        <!-- Anmerkung 1 -->
                                        <div class="card mb-3">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between align-items-start mb-2">
                                                    <div>
                                                        <strong class="text-primary">Martin Weber</strong>
                                                        <span class="badge bg-primary ms-2">Record Owner</span>
                                                    </div>
                                                    <small class="text-muted">15.01.2024, 14:30</small>
                                                </div>
                                                <p class="mb-2">Die Geburtsdaten müssen noch verifiziert werden. Laut Archivunterlagen könnte das Geburtsjahr 1829 statt 1884 sein.</p>
                                                
                                                <!-- Kommentare zur Anmerkung 1 -->
                                                <div class="ms-4 mt-3 border-start border-3 border-secondary ps-3">
                                                    <div class="mb-3">
                                                        <div class="d-flex justify-content-between align-items-start mb-1">
                                                            <div>
                                                                <strong>Eduard Schill</strong>
                                                                <span class="badge bg-primary ms-2">Record Owner</span>
                                                            </div>
                                                            <small class="text-muted">15.01.2024, 16:45</small>
                                                        </div>
                                                        <p class="mb-0 small">Ich habe die Originalquelle geprüft - 1885 ist korrekt. Bitte aktualisieren.</p>
                                                    </div>
                                                    
                                                    <div class="mb-3">
                                                        <div class="d-flex justify-content-between align-items-start mb-1">
                                                            <div>
                                                                <strong>Martin Weber</strong>
                                                                <span class="badge bg-primary ms-2">Record Owner</span>
                                                            </div>
                                                            <small class="text-muted">16.01.2024, 09:15</small>
                                                        </div>
                                                        <p class="mb-0 small">Danke für die Klärung! Ich werde das Datum entsprechend anpassen.</p>
                                                    </div>
                                                </div>
                                                
                                                <button type="button" class="btn btn-sm btn-outline-secondary mt-2">
                                                    <i class="bi bi-chat-dots"></i> Kommentar abgeben
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Anmerkung 2 -->
                                        <div class="card mb-3">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between align-items-start mb-2">
                                                    <div>
                                                        <strong class="text-primary">Johannes Kraft</strong>
                                                        <span class="badge bg-warning text-dark ms-2">DB Owner</span>
                                                    </div>
                                                    <small class="text-muted">12.01.2024, 11:20</small>
                                                </div>
                                                <p class="mb-2">ORCID-Nummer wurde von der Person selbst bestätigt. Alle Publikationen sind korrekt zugeordnet.</p>
                                                
                                                <!-- Kommentare zur Anmerkung 2 -->
                                                <div class="ms-4 mt-3 border-start border-3 border-secondary ps-3">
                                                    <div class="mb-3">
                                                        <div class="d-flex justify-content-between align-items-start mb-1">
                                                            <div>
                                                                <strong>Martin Weber</strong>
                                                                <span class="badge bg-primary ms-2">Record Owner</span>
                                                            </div>
                                                            <small class="text-muted">12.01.2024, 14:00</small>
                                                        </div>
                                                        <p class="mb-0 small">Sehr gut, danke für die Bestätigung!</p>
                                                    </div>
                                                </div>
                                                
                                                <button type="button" class="btn btn-sm btn-outline-secondary mt-2">
                                                    <i class="bi bi-chat-dots"> Kommentar abgeben</i>
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Anmerkung 3 -->
                                        <div class="card mb-3">
                                            <div class="card-body">
                                                <div class="d-flex justify-content-between align-items-start mb-2">
                                                    <div>
                                                        <strong class="text-primary">Michaela Berger</strong>
                                                        <span class="badge bg-primary ms-2">Record Owner</span>
                                                    </div>
                                                    <small class="text-muted">10.01.2024, 10:05</small>
                                                </div>
                                                <p class="mb-2">Bei der Recherche habe ich weitere Wirkungsorte gefunden: Graz (1920-1925) und Innsbruck (1925-1930). Soll ich diese ergänzen?</p>
                                                
                                                <!-- Kommentare zur Anmerkung 3 -->
                                                <div class="ms-4 mt-3 border-start border-3 border-secondary ps-3">
                                                    <div class="mb-3">
                                                        <div class="d-flex justify-content-between align-items-start mb-1">
                                                            <div>
                                                                <strong>Kati Schmidt</strong>
                                                                <span class="badge bg-warning text-dark ms-2">DB Owner</span>
                                                            </div>
                                                            <small class="text-muted">10.01.2024, 11:30</small>
                                                        </div>
                                                        <p class="mb-0 small">Ja bitte, aber füge auch die Quellen hinzu.</p>
                                                    </div>
                                                    
                                                    <div class="mb-3">
                                                        <div class="d-flex justify-content-between align-items-start mb-1">
                                                            <div>
                                                                <strong>Miachela Berger</strong>
                                                                <span class="badge bg-primary ms-2">Record Owner</span>
                                                            </div>
                                                            <small class="text-muted">10.01.2024, 15:20</small>
                                                        </div>
                                                        <p class="mb-0 small">Erledigt! Quellen: Universitätsarchiv Graz, Personalakte Nr. 1234 und Tiroler Landesarchiv, Bestand XY.</p>
                                                    </div>

                                                    <div class="mb-3">
                                                        <div class="d-flex justify-content-between align-items-start mb-1">
                                                            <div>
                                                                <strong>Kati Schmidt</strong>
                                                                <span class="badge bg-warning text-dark ms-2">DB Owner</span>
                                                            </div>
                                                            <small class="text-muted">11.01.2024, 08:45</small>
                                                        </div>
                                                        <p class="mb-0 small">Hervorragende Arbeit! Die Zeiträume passen auch zu den bekannten Publikationen.</p>
                                                    </div>
                                                </div>
                                                
                                                <button type="button" class="btn btn-sm btn-outline-secondary mt-2">
                                                    <i class="bi bi-chat-dots"></i> Kommentar abgeben
                                                </button>
                                            </div>
                                        </div>

                                        <!-- Button zum Hinzufügen neuer Anmerkungen -->
                                        <button type="button" class="btn btn-sm btn-outline-primary">
                                            <i class="bi bi-plus-circle"></i> Neue Anmerkung hinzufügen
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- 11. RECORD HISTORY -->
                        <section id="record_history" class="form-section mb-5">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h3 class="h5 mb-0">Record History</h3>
                                    <button type="button" class="btn btn-sm btn-outline-info" data-bs-toggle="modal" data-bs-target="#recordHistoryInfoModal">
                                        <i class="bi bi-info-circle"></i> Erklärung
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover align-middle">
                                            <thead>
                                                <tr>
                                                    <th>Aktion</th>
                                                    <th>Beschreibung</th>
                                                    <th>by username</th>
                                                    <th>at timestamp</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td><span class="badge bg-primary">Imported</span></td>
                                                    <td>Datensatz via Batch-Import (Birdcollection-Feed) angelegt</td>
                                                    <td>system.importer</td>
                                                    <td>2024-05-11 08:15</td>
                                                </tr>
                                                <tr>
                                                    <td><span class="badge bg-success">Update</span></td>
                                                    <td>Normdaten aktualisiert (GND + Wikidata)</td>
                                                    <td>awuelle</td>
                                                    <td>2024-06-02 14:33</td>
                                                </tr>
                                                <tr>
                                                    <td><span class="badge bg-warning text-dark">Duplicated</span></td>
                                                    <td>Datensatz dupliziert für Zweitfassung (VS-Bestand)</td>
                                                    <td>pfischer</td>
                                                    <td>2024-07-19 10:02</td>
                                                </tr>
                                                <tr>
                                                    <td><span class="badge bg-danger">Delete</span></td>
                                                    <td>Verworfen, da Dublette von ATT-03042</td>
                                                    <td>db_owner</td>
                                                    <td>2024-07-20 09:48</td>
                                                </tr>
                                                <tr>
                                                    <td><span class="badge bg-info text-dark">Merged</span></td>
                                                    <td>Zusammengeführt aus IDX=ATT-03001 und IDZ=ATT-03017</td>
                                                    <td>k.schmidt</td>
                                                    <td>2024-08-01 16:21</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- 12. IMPORTDATEN (READONLY) -->
                        <section id="import" class="form-section mb-5 disabled-section" data-role-restriction="user" data-hide-when-restricted="true">
                            <div class="card">
                                <div class="card-header">
                                    <h3 class="h5 mb-0">Importdaten (Readonly)</h3>
                                </div>
                                <div class="card-body">
                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <label for="import_quelle" class="form-label">Import-Quelle</label>
                                            <input type="text" class="form-control" id="import_quelle" name="import_quelle" value="Birdcollection" readonly disabled>
                                        </div>
                                        <div class="col-md-6">
                                            <label for="import_datum" class="form-label">Import-Datum</label>
                                            <input type="text" class="form-control" id="import_datum" name="import_datum"  value="2026-01-01 09:33:11" readonly disabled>
                                        </div>
                                        <div class="col-md-12">
                                            <label for="import_quelldaten" class="form-label">Import-Quelldaten</label>
                                            <button id="copyJson" type="button" class="btn btn-sm btn-outline-primary">Kopieren</button>
                                            <button id="rawToggle" type="button" class="btn btn-sm btn-outline-secondary">Raw</button>
                                            <br>
                                            <!-- original textarea (hidden) kept for copy/export -->
                                            <textarea id="import_quelldaten" name="import_quelldaten" class="d-none" aria-hidden="true">
                                                {
                                                    "person_id": "550e8400-e29b-41d4-a716-446655440000",
                                                    "identitaet": {
                                                        "vorname": "Ferdinand",
                                                        "mittelname": null,
                                                        "nachname": "von Hochstetter",
                                                        "anzeigename": "Hochstetter, Ferdinand von",
                                                        "namensvarianten": [
                                                            "F. Hochstetter",
                                                            "Ferdinand Hochstetter"
                                                        ],
                                                        "namenskuerzel": "F.H.",
                                                        "lebensstatus": "verstorben",
                                                        "geschlecht": "männlich"
                                                    },
                                                    "titel": {
                                                        "akad_titel": [
                                                            "Dr.",
                                                            "Prof."
                                                        ],
                                                        "standes_und_amtstitel": [
                                                            {
                                                                "bezeichnung": "k. k. Hofrat",
                                                                "typ": "Amtstitel",
                                                                "gueltig_von": null,
                                                                "gueltig_bis": null
                                                            }
                                                        ]
                                                    },
                                                    "biografie": {
                                                        "geburtsdatum": "1829-04",
                                                        "sterbedatum": "1884-07-18",
                                                        "geburtsort": "Esslingen am Neckar",
                                                        "sterbeort": "Wien",
                                                        "wirkungsorte": [
                                                            "Neuseeland",
                                                            "Wien",
                                                            "Triest"
                                                        ]
                                                    },
                                                    "taetigkeiten": {
                                                        "beruf_funktionen": [
                                                            "Direktor",
                                                            "Geologe",
                                                            "Naturforscher",
                                                            "Professor für Geologie und Mineralogie"
                                                        ],
                                                        "institution": "Naturhistorisches Hofmuseum",
                                                        "abteilungen": [
                                                            "Direktion",
                                                            "Geologie & Paläontologie"
                                                        ],
                                                        "rolle": "Sammler",
                                                        "zeitraum": "1857–1865"
                                                    },
                                                    "kontakte": {
                                                        "email": null,
                                                        "telefon": null,
                                                        "adresse_roh": "Mariahilfer Straße 12, 1060 Wien, Österreich"
                                                    },
                                                    "normdaten": {
                                                        "orcid": null,
                                                        "viaf": "37065520",
                                                        "gnd": "118552161",
                                                        "wikidata": "Q69947",
                                                        "isni": "0000 0000 8088 0918",
                                                        "lcnaf": "n50015168",
                                                        "bnf": "cb123456789",
                                                        "bhl": "Hochstetter,_Ferdinand_von",
                                                        "zoobank": "urn:lsid:zoobank.org:author:12345",
                                                        "ulan": "500034875"
                                                    },
                                                    "webseiten": {
                                                        "nhmw_profil_url": null,
                                                        "wikipedia": "https://de.wikipedia.org/wiki/Ferdinand_von_Hochstetter",
                                                        "zobodat": "https://www.zobodat.at/personen.php?id=12345"
                                                    },
                                                    "kommentare": [
                                                        {
                                                            "text": "Historische Titel: Dr. und Professor und k. k. Hofrath.",
                                                            "by_user": "XYZ",
                                                            "created_at": "2025-11-11T14:32:00"
                                                        },
                                                        {
                                                            "text": "Von ihm stammt die erste geologische Übersichtskarte des Balkangebietes.",
                                                            "by_user": "ZXY",
                                                            "created_at": "2023-01-01T10:02:00"
                                                        }
                                                    ],
                                                    "quellen": {
                                                        "liste": [
                                                            "NHMW Archiv",
                                                            "ZOBODAT",
                                                            "Digitalisat des Expeditionstagebuchs"
                                                        ]
                                                    }
                                                }
                                            </textarea>
                                            <pre id="import_quelldaten_pre" class="json-pre" role="region" aria-label="Import Quelldaten (JSON-LD)"></pre>
                                            <textarea id="import_quelldaten_raw" class="d-none form-control" rows="20" readonly aria-hidden="true"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>

                    </form>
                </div>
            </div>

            <!-- Sidebar Navigation -->
            <div class="col-md-3 col-lg-2 order-md-2">
                <div class="sidebar">
                    <div class="card mb-3 shadow-sm">
                        <div class="card-body py-3">
                            <strong id="sidebarAnzeigename" class="d-block">—</strong>
                            <small id="sidebarAnzeigenameMeta" class="text-muted"></small>
                        </div>
                    </div>
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h5>Navigation</h5>
                        <button id="themeToggle" class="btn btn-sm btn-outline-secondary" title="Theme wechseln">
                            <i class="bi bi-moon-fill"></i>
                        </button>
                    </div>
                    <nav id="navbar-sections" class="nav flex-column">
                        <a class="nav-link" href="#userrolle">User-Rolle</a>
                        <a class="nav-link" href="#lebensstatus">Lebensstatus</a>
                        <a class="nav-link" href="#anzeigename">Anzeigename</a>
                        <a class="nav-link" href="#identitaet">Identität</a>
                        <a class="nav-link" href="#normdaten">Normdaten</a>
                        <a class="nav-link" href="#lebensdaten">Lebensdaten</a>
                        <a class="nav-link" href="#taetigkeiten">Tätigkeiten / Rollen</a>
                        <a class="nav-link" href="#orte">Orte</a>
                        <a class="nav-link" href="#kontakt">Kontakt</a>
                        <a class="nav-link" href="#quellenangaben">Quellenangaben</a>
                        <a class="nav-link" href="#meta">Anmerkungen</a>
                        <a class="nav-link" href="#record_history">Record History</a>
                        <a class="nav-link" href="#import">Importdaten</a>
                    </nav>
                    <div class="sidebar-actions d-grid gap-2 mt-auto">
                        <button type="button" id="backToTop" class="btn btn-outline-secondary w-100 nav-highlight" aria-label="Nach oben scrollen">
                            <i class="bi bi-arrow-up"></i> Back to Top
                        </button>
                        <button id="resetForm" class="btn btn-outline-danger w-100" title="Formular zurücksetzen">
                            <i class="bi bi-arrow-counterclockwise"></i> Formular zurücksetzen
                        </button>
                        <button id="exportJson" class="btn btn-primary w-100">
                            <i class="bi bi-download"></i> JSON exportieren
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Standes- und Amtstitel Modal -->
    <div class="modal fade" id="standesTitelModal" tabindex="-1" aria-labelledby="standesTitelModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="standesTitelModalLabel">Standes- und Amtstitel – Auswahl</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="text-muted small">Auswahlliste für den Autocomplete im Feld „Standes- und Amtstitel“.</p>
                    <ul class="list-unstyled mb-0">
                        <li>Abt</li>
                        <li>Äbtissin</li>
                        <li>Baron</li>
                        <li>Baronin</li>
                        <li>Diakon</li>
                        <li>Domdechant</li>
                        <li>Domherr</li>
                        <li>Edle</li>
                        <li>Edler</li>
                        <li>Erzbischof</li>
                        <li>Erzherzog</li>
                        <li>Erzherzogin</li>
                        <li>Erzpriester</li>
                        <li>Feldmarschall</li>
                        <li>Feldmarschalleutnant</li>
                        <li>Frater</li>
                        <li>Freifrau</li>
                        <li>Freiherr</li>
                        <li>Freiin</li>
                        <li>Fürst</li>
                        <li>Fürstin</li>
                        <li>General</li>
                        <li>Generalleutnant</li>
                        <li>Generalmajor</li>
                        <li>Graf</li>
                        <li>Gräfin</li>
                        <li>Hauptmann</li>
                        <li>Herzog</li>
                        <li>Herzogin</li>
                        <li>Hoflieferant</li>
                        <li>Hofrat</li>
                        <li>Hofrätin</li>
                        <li>Hofsekretär</li>
                        <li>Junker</li>
                        <li>k. k.</li>
                        <li>k. u. k.</li>
                        <li>k.k.</li>
                        <li>k.u.k.</li>
                        <li>Kaiser</li>
                        <li>Kaiserin</li>
                        <li>kaisl.</li>
                        <li>Kammerherr</li>
                        <li>Kaplan</li>
                        <li>Kardinal</li>
                        <li>kgl.</li>
                        <li>König</li>
                        <li>Königin</li>
                        <li>Leutnant</li>
                        <li>Major</li>
                        <li>Mönch</li>
                        <li>Nonne</li>
                        <li>Oberst</li>
                        <li>Obersthofmeister</li>
                        <li>Oberstkämmerer</li>
                        <li>Oberstleutnant</li>
                        <li>Obrist</li>
                        <li>Ordensbruder</li>
                        <li>Ordensschwester</li>
                        <li>Papst</li>
                        <li>Pater</li>
                        <li>Pfarrer</li>
                        <li>Prälat</li>
                        <li>Prinz</li>
                        <li>Prinzessin</li>
                        <li>Prior</li>
                        <li>Priorin</li>
                        <li>Propst</li>
                        <li>Ritter</li>
                        <li>Rittmeister</li>
                        <li>Subdiakon</li>
                        <li>von</li>
                        <li>Weihbischof</li>
                        <li>zu</li>
                    </ul>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Schließen</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Akademischer Titel Modal -->
    <div class="modal fade" id="akademischeTitelModal" tabindex="-1" aria-labelledby="akademischeTitelModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="akademischeTitelModalLabel">Akademische Titel – Auswahl</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="text-muted small">Auswahlliste für den Autocomplete im Feld „Akademischer Titel“.</p>
                    <ul class="list-unstyled mb-0">
                        <li>ao. Univ.-Prof.</li>
                        <li>ao. Univ.-Prof.in</li>
                        <li>B.A.</li>
                        <li>B.Ed.</li>
                        <li>B.Eng.</li>
                        <li>B.F.A.</li>
                        <li>B.Mus.</li>
                        <li>B.Sc.</li>
                        <li>BA</li>
                        <li>BEd</li>
                        <li>BSc</li>
                        <li>Cand. med.</li>
                        <li>CAS</li>
                        <li>D.M.A.</li>
                        <li>D.Sc.</li>
                        <li>DAS</li>
                        <li>DDr.</li>
                        <li>DI</li>
                        <li>Dipl.-Ing.</li>
                        <li>Dipl.-Ing.in</li>
                        <li>Doz.</li>
                        <li>Doz.in</li>
                        <li>Dr.</li>
                        <li>Dr. habil.</li>
                        <li>Dr. iur.</li>
                        <li>Dr. jur.</li>
                        <li>Dr. med.</li>
                        <li>Dr. med. vet.</li>
                        <li>Dr. phil.</li>
                        <li>Dr. rer. nat.</li>
                        <li>Dr. rer. pol.</li>
                        <li>Dr. rer. soc.</li>
                        <li>Dr. techn.</li>
                        <li>Dr. theol.</li>
                        <li>Dr.in</li>
                        <li>Ed.D.</li>
                        <li>HTL-Ing.</li>
                        <li>Ing.</li>
                        <li>J.D.</li>
                        <li>JD</li>
                        <li>LL.B.</li>
                        <li>LL.M.</li>
                        <li>M.A.</li>
                        <li>M.Ed.</li>
                        <li>M.Eng.</li>
                        <li>M.F.A.</li>
                        <li>M.Mus.</li>
                        <li>M.Phil.</li>
                        <li>M.Sc.</li>
                        <li>MA</li>
                        <li>Mag.</li>
                        <li>Mag.a</li>
                        <li>MAS</li>
                        <li>MBA</li>
                        <li>MD</li>
                        <li>MEd</li>
                        <li>MEng</li>
                        <li>MMag.</li>
                        <li>MPA</li>
                        <li>MPH</li>
                        <li>MPhil</li>
                        <li>MSc</li>
                        <li>PD</li>
                        <li>Ph.D.</li>
                        <li>PhD</li>
                        <li>Priv.-Doz.</li>
                        <li>Priv.-Doz.in</li>
                        <li>Prof.</li>
                        <li>Prof.in</li>
                        <li>Sc.D.</li>
                        <li>StB</li>
                        <li>Th.D.</li>
                        <li>Univ. Mag.</li>
                        <li>Univ.-Doz.</li>
                        <li>Univ.-Doz.in</li>
                        <li>Univ.-Prof.</li>
                        <li>Univ.-Prof.in</li>
                    </ul>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Schließen</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Record History Info Modal -->
    <div class="modal fade" id="recordHistoryInfoModal" tabindex="-1" aria-labelledby="recordHistoryInfoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="recordHistoryInfoModalLabel">Record History – Erklärung</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="lead text-muted">Datensatzhistorien (Record history) – Aktionen in Bezug auf einen Datensatz</p>
                    <p>Record history = Änderungsverlauf eines einzelnen Datensatzes im System. Sie zeichnet alle Bearbeitungen am Datensatz nach: wer was wann geändert hat. Fokus liegt auf der digitalen Repräsentation (Versionierung, Audit-Trail, Metadaten-Änderungen).</p>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="card border-primary h-100">
                                <div class="card-header bg-primary text-white">
                                    Datensatz-Aktionen
                                </div>
                                <div class="card-body">
                                    <ul class="mb-0">
                                        <li>Imported – Datensatz importiert ODER Create – Datensatz neu angelegt</li>
                                        <li>Update – Datensatz geändert</li>
                                        <li>Delete – Datensatz gelöscht</li>
                                        <li>Duplicated – Datensatz dupliziert</li>
                                        <li>Merged – Datensatz zusammengeführt aus Datensätzen IDX und IDZ</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card border-secondary h-100">
                                <div class="card-header bg-secondary text-white">
                                    Metadaten zu Aktionen
                                </div>
                                <div class="card-body">
                                    <ul class="mb-0">
                                        <li><strong>by username</strong> – welcher Benutzer die Aktion durchgeführt hat</li>
                                        <li><strong>at timestamp</strong> – Zeitpunkt der Aktion</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Schließen</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="autocomplete-data.js"></script>
    <script src="validation.js"></script>
    <script src="theme.js"></script>
    <script src="form.js"></script>
    <script>
        (function () {
            const navLinks = Array.from(document.querySelectorAll("#navbar-sections .nav-link"));
            if (!navLinks.length) return;

            navLinks.forEach(link => {
                link.addEventListener("click", function (event) {
                    const targetId = this.getAttribute("href")?.replace("#", "");
                    if (!targetId) return;
                    const section = document.getElementById(targetId);
                    if (!section) return;
                    event.preventDefault();
                    const offset = 80;
                    const top = section.getBoundingClientRect().top + window.scrollY - offset;
                    window.scrollTo({ top, behavior: "smooth" });
                });
            });

            const sectionLinkMap = new Map();
            navLinks.forEach(link => {
                const id = link.getAttribute("href")?.replace("#", "");
                if (!id) return;
                const section = document.getElementById(id);
                if (section) {
                    sectionLinkMap.set(section, link);
                }
            });

            const sections = Array.from(sectionLinkMap.keys());
            if (!sections.length) {
                navLinks[0].classList.add("active");
                return;
            }

            const clearActive = () => navLinks.forEach(link => link.classList.remove("active"));
            const activate = (section) => {
                const link = sectionLinkMap.get(section);
                if (!link) return;
                clearActive();
                link.classList.add("active");
            };

            if (!("IntersectionObserver" in window)) {
                activate(sections[0]);
                return;
            }

            const observer = new IntersectionObserver(
                entries => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            activate(entry.target);
                        }
                    });
                },
                { rootMargin: "-35% 0px -45% 0px", threshold: 0.25 }
            );

            sections.forEach(section => observer.observe(section));
            activate(sections[0]);
        })();
    </script>
    <script>
        (function () {
            const sourceField = document.getElementById("import_quelldaten");
            const formattedTarget = document.getElementById("import_quelldaten_pre");
            const rawField = document.getElementById("import_quelldaten_raw");
            const copyButton = document.getElementById("copyJson");
            const rawToggleButton = document.getElementById("rawToggle");

            if (!sourceField || !formattedTarget) {
                return;
            }

            const rawJson = (sourceField.value || sourceField.textContent || "").trim();

            function formatJson(value) {
                try {
                    return JSON.stringify(JSON.parse(value), null, 4);
                } catch (error) {
                    return value;
                }
            }

            const formattedJson = formatJson(rawJson);

            function escapeHtml(str) {
                return str.replace(/&/g, "&amp;")
                    .replace(/</g, "&lt;")
                    .replace(/>/g, "&gt;")
                    .replace(/"/g, "&quot;");
            }

            function syntaxHighlight(jsonText) {
                const escaped = escapeHtml(jsonText);
                return escaped.replace(/("(\\u[\da-fA-F]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g, match => {
                    let cls = "json-number";
                    if (/^"/.test(match)) {
                        cls = /:$/.test(match) ? "json-key" : "json-string";
                    } else if (/true|false/.test(match)) {
                        cls = "json-boolean";
                    } else if (/null/.test(match)) {
                        cls = "json-null";
                    }
                    return `<span class="${cls}">${match}</span>`;
                });
            }

            function renderFormattedView() {
                formattedTarget.innerHTML = syntaxHighlight(formattedJson);
            }

            function setRawVisibility(showRaw) {
                if (!rawField) return;
                if (showRaw) {
                    rawField.classList.remove("d-none");
                    rawField.removeAttribute("aria-hidden");
                    rawField.value = formattedJson;
                    formattedTarget.classList.add("d-none");
                    if (rawToggleButton) {
                        rawToggleButton.textContent = "Formatiert";
                    }
                } else {
                    rawField.classList.add("d-none");
                    rawField.setAttribute("aria-hidden", "true");
                    formattedTarget.classList.remove("d-none");
                    if (rawToggleButton) {
                        rawToggleButton.textContent = "Raw";
                    }
                }
            }

            if (rawToggleButton && rawField) {
                rawToggleButton.addEventListener("click", () => {
                    const showRaw = rawField.classList.contains("d-none");
                    setRawVisibility(showRaw);
                });
            }

            if (copyButton) {
                copyButton.addEventListener("click", () => {
                    const textToCopy = !rawField || rawField.classList.contains("d-none")
                        ? formattedJson
                        : rawField.value;
                    if (navigator.clipboard && navigator.clipboard.writeText) {
                        navigator.clipboard.writeText(textToCopy).catch(() => { /* ignore */ });
                    } else {
                        const temp = document.createElement("textarea");
                        temp.value = textToCopy;
                        temp.style.position = "fixed";
                        temp.style.opacity = "0";
                        document.body.appendChild(temp);
                        temp.focus();
                        temp.select();
                        try {
                            document.execCommand("copy");
                        } catch (error) {
                            /* ignore */
                        }
                        document.body.removeChild(temp);
                    }
                });
            }

            renderFormattedView();
            setRawVisibility(false);
        })();
    </script>
    <script>
        (function () {
            const button = document.getElementById("backToTop");
            if (!button) return;

            function toggleVisibility() {
                const shouldShow = window.scrollY > 240;
                button.classList.toggle("show", shouldShow);
            }

            button.addEventListener("click", () => {
                window.scrollTo({ top: 0, behavior: "smooth" });
            });

            window.addEventListener("scroll", toggleVisibility, { passive: true });
            toggleVisibility();
        })();
    </script>
</body>
</html>
